@tailwind base;
@tailwind components;
@tailwind utilities;

/* GradientText color cycle — replaces JS setInterval for zero CPU overhead */
@keyframes gradientTextCycle {
  0%, 100% { color: #3404f6; }
  50%       { color: #f40101; }
}

/* Logo Loop Keyframes - Must be outside Tailwind layers to prevent purging */
@keyframes scrollLeft {
  from {
    -webkit-transform: translateX(0);
    transform: translateX(0);
  }
  to {
    -webkit-transform: translateX(-50%);
    transform: translateX(-50%);
  }
}

@keyframes scrollRight {
  from {
    -webkit-transform: translateX(-50%);
    transform: translateX(-50%);
  }
  to {
    -webkit-transform: translateX(0);
    transform: translateX(0);
  }
}

/* Ensure HTML element has transparent background to show hero image */
html {
  background-color: transparent !important;
  background: transparent !important;
  /* Native smooth scrolling for better performance */
  scroll-behavior: smooth;
  /* Optimize scrolling performance */
  overflow-x: hidden;
  overflow-y: scroll;
}

/* CRITICAL: Override Tailwind Preflight white backgrounds immediately after utilities */
/* Tailwind Preflight sets background-color: white on body and other elements */
/* We need to override this BEFORE our section-specific rules */

/* IMMEDIATE OVERRIDE: Prevent Tailwind Preflight from setting white backgrounds */
/* Tailwind Preflight includes: body { background-color: white; } */
/* Set to transparent so hero image shows through */
body {
  background-color: transparent !important;
  background: transparent !important;
  /* Optimize scroll performance */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeSpeed;
}

/* Removed - handled by comprehensive rule below */

/* Glassmorphism for header — reduced blur for scroll performance */
header {
  backdrop-filter: blur(8px);
  -webkit-backdrop-filter: blur(8px);
  transition:
    background-color 0.9s ease,
    color 0.9s ease;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* Additional HTML properties (background already set above) */
html {
  scroll-padding-top: 180px; /* Account for fixed header */
}

/* scroll-behavior: smooth removed — it was applying to all programmatic
   window.scrollTo() calls too, conflicting with the custom JS scroll logic */

/* Additional body properties (background and font smoothing already set above) */
body {
  font-family:
    'Fjalla One',
    sans-serif;
}

/* Performance optimizations for all interactive elements */
button,
a,
[role='button'] {
  touch-action: manipulation;
  -webkit-tap-highlight-color: transparent;
}

/* Layout containment for sections (no broad GPU hints) */
.scroll-optimized,
[data-scroll-section],
section {
  contain: layout;
}

/* Prevent white flash during image loading */
img {
  background-color: transparent;
  image-rendering: -webkit-optimize-contrast;
  image-rendering: crisp-edges;
}

/* Smooth image fade-in */
img[loading="lazy"],
img[loading="eager"] {
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
}

img[loading="lazy"].loaded,
img[loading="eager"].loaded,
img:not([loading]) {
  opacity: 1;
}

/* Ensure images display once loaded */
img[src] {
  opacity: 1;
}

/* Optimize font rendering for smoothness — only on headings to avoid slowing every text node */
.section-title, h1, h2, h3 {
  text-rendering: optimizeLegibility;
}

/* Smooth scrolling momentum on iOS */
* {
  -webkit-overflow-scrolling: touch;
}

/* Prevent layout shifts during animations */
img,
video {
  max-width: 100%;
}

/* Ensure no white bar appears above header - hero section extends to top */
#root {
  background-color: transparent;
  min-height: 100vh;
}

/* Ensure hero section starts at very top with no white space */
#hero {
  margin-top: 0 !important;
  padding-top: 0 !important;
  top: 0 !important;
  position: relative !important;
}

/* Make hero background extend to very top of viewport - fixed to cover header gap */
#hero > div:first-child,
#hero > div:nth-child(2) {
  top: 0 !important;
  left: 0 !important;
  right: 0 !important;
  height: 100vh !important;
  width: 100% !important;
  position: fixed !important;
  z-index: -2 !important;
}

/* Force transparent background (hero image will show through) */
html,
body,
#root {
  background: transparent !important;
  background-color: transparent !important;
}

/* Ensure main element doesn't have white background */
/* But allow wrapper div to have grey background */
/* Main element background is controlled via inline styles in Home.jsx for dynamic Sanity images */
/* Do not add background rules here as they will override the dynamic background */

/* Fixed background layer - optimized for scroll performance */
.main-with-fixed-bg::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: #1e293b;
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-image: var(--bg-url, linear-gradient(135deg, #1e293b 0%, #334155 100%));
  z-index: -1;
  transform: translateZ(0);
  backface-visibility: hidden;
  pointer-events: none;
}

/* Apply gradient overlay when background image exists */
.main-with-fixed-bg:not([style*="--bg-url: none"])::before {
  background-image: 
    linear-gradient(rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.4)),
    var(--bg-url, linear-gradient(135deg, #1e293b 0%, #334155 100%));
}

/* Wrapper div must also be transparent to allow hero image to show through */
body > main > div.bg-gray-50,
body > main > div {
  background-color: transparent !important;
  background: transparent !important;
}

/* These rules are now handled by the comprehensive rule below */

/* Ensure sections with bg-gray-700 maintain their background */
section#services.bg-gray-700,
section#portfolio.bg-gray-700,
section#careers.bg-gray-700 {
  background-color: #374151 !important;
}

/* Ensure Contact section (last child) can have its background image */
/* Override wrapper grey background so Contact image shows through */
/* Use maximum specificity to override wrapper div's inline style */
body > main > div > section:last-child,
body > main > div > section#contact,
section#contact {
  background-color: transparent !important;
  background: transparent !important;
  /* Ensure background-image can show through */
  background-image: inherit !important;
  position: relative !important;
  overflow: visible !important;
}

/* Ensure Contact section background elements display properly */
section#contact > div[class*='absolute'] {
  position: absolute !important;
}

/* Safety Images Grid */
.safety-images-grid {
  display: grid;
  gap: 20px;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  margin-top: 20px;
}

.safety-photo {
  width: 100%;
  height: auto;
  border-radius: 12px;
  object-fit: cover;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  display: block;
}

/* Portfolio Modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.85);
  display: flex;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(8px);
  z-index: 9999;
}

.modal {
  background: #1f2937;
  padding: 20px;
  border-radius: 12px;
  width: 550px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
}

.modal-img {
  width: 100%;
  border-radius: 12px;
  margin-bottom: 15px;
}

/* Legacy portfolio-modal class for backwards compatibility */
.portfolio-modal {
  position: fixed;
  inset: 0;
  backdrop-filter: blur(6px);
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
  animation: fadeIn 0.2s;
}

.modal-content {
  background: #1f2937;
  padding: 24px;
  border-radius: 18px;
  width: 600px;
  max-height: 80vh;
  overflow-y: auto;
  box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
  position: relative;
  animation: popup 0.25s ease;
}

@keyframes fadeIn {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

@keyframes popup {
  from {
    opacity: 0;
    transform: scale(0.9);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes shimmer {
  0% {
    transform: translateX(-120%);
  }
  100% {
    transform: translateX(120%);
  }
}

.animate-shimmer {
  animation: shimmer 2.5s ease-in-out infinite;
}

.modal-content h2 {
  font-size: 2rem;
  font-weight: bold;
  margin-bottom: 20px;
  color: #ffffff;
}

.modal-content img {
  width: 100%;
  height: auto;
  border-radius: 12px;
  margin-bottom: 20px;
  object-fit: cover;
}

.modal-content p {
  font-size: 1.1rem;
  line-height: 1.6;
  color: #e5e7eb;
  margin-bottom: 24px;
}

.modal-content button {
  background: #3b82f6;
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}

.modal-content button:hover {
  background: #2563eb;
}

.cardswap-wrapper {
  position: relative !important;
}

.service-card {
  border-radius: 0 !important;
  overflow: hidden !important;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15) !important;
}

.service-card img {
  width: 100% !important;
  height: 100% !important;
  object-fit: cover !important;
  border-radius: 0 !important;
  display: block !important;
}

/* Hero Text Effect - Gray text with black semi-transparent stroke */
.hero-3d-text {
  text-transform: uppercase;
  margin-bottom: 0.5em;
  font-family: 'Rubik', sans-serif;
  font-size: clamp(3rem, 5vw + 1rem, 6rem);
  font-weight: 900;
  position: relative;
  display: inline-block;
  color: #808080; /* Gray text */
  text-shadow:
    1px 1px 0px rgba(0, 0, 0, 0.8),
    2px 2px 0px rgba(0, 0, 0, 0.7),
    3px 3px 0px rgba(0, 0, 0, 0.6),
    4px 4px 0px rgba(0, 0, 0, 0.5),
    5px 5px 0px rgba(0, 0, 0, 0.3),
    0 0 15px rgba(0, 0, 0, 0.4);
  -webkit-text-stroke: 4px rgba(0, 0, 0, 0.6);
  paint-order: stroke fill;
}

@media (min-width: 768px) {
  .hero-3d-text {
    font-size: clamp(4rem, 4vw + 2rem, 7rem);
  }
}

@media (min-width: 1440px) {
  .hero-3d-text {
    font-size: clamp(5rem, 3.5vw + 2rem, 6.5rem);
  }
}

@media (min-width: 2560px) {
  .hero-3d-text {
    font-size: clamp(5rem, 2.5vw + 2rem, 6rem);
  }
}

/* Smaller "Since" styling - keeps cursive font */
.hero-since {
  font-size: 1em;
  margin-right: 0.4em;
  display: inline-block;
  font-family: 'Corinthia', cursive;
  text-transform: capitalize;
  color: #808080; /* Gray text */
  text-shadow:
    1px 1px 0px rgba(0, 0, 0, 0.8),
    2px 2px 0px rgba(0, 0, 0, 0.7),
    3px 3px 0px rgba(0, 0, 0, 0.6),
    4px 4px 0px rgba(0, 0, 0, 0.5),
    5px 5px 0px rgba(0, 0, 0, 0.3),
    0 0 15px rgba(0, 0, 0, 0.4);
  -webkit-text-stroke: 1.5px rgba(0, 0, 0, 0.6);
  paint-order: stroke fill;
}

/* 1963 styling with black stroke */
/* Color is set dynamically via inline style in HeroSection component */
.hero-1963 {
  font-family: 'Rubik', sans-serif;
  font-weight: 900;
  text-shadow:
    1px 1px 0px rgba(0, 0, 0, 0.8),
    2px 2px 0px rgba(0, 0, 0, 0.7),
    3px 3px 0px rgba(0, 0, 0, 0.6),
    4px 4px 0px rgba(0, 0, 0, 0.5),
    5px 5px 0px rgba(0, 0, 0, 0.3),
    0 0 15px rgba(0, 0, 0, 0.4);
  -webkit-text-stroke: 2px rgba(0, 0, 0, 0.6);
  paint-order: stroke fill;
}

/* Section Titles - Same font as hero */
.section-title {
  font-family: 'Rubik', sans-serif;
  font-weight: 900;
  text-transform: uppercase;
}

/* Hero Button 3D Effect — box-shadow replaces expensive 6-chain drop-shadow() filter */
.hero-button-3d {
  transform-style: preserve-3d;
  transform: translateZ(0) rotateY(-3deg) rotateX(2deg);
  will-change: transform;
  backface-visibility: hidden;
  -webkit-font-smoothing: antialiased;
  transition:
    transform 0.35s cubic-bezier(0.4, 0, 0.2, 1),
    box-shadow 0.35s cubic-bezier(0.4, 0, 0.2, 1);
  box-shadow:
    2px 2px 0px rgba(58, 62, 66, 0.5),
    5px 5px 12px rgba(0, 0, 0, 0.3);
}

.hero-button-3d:hover {
  transform: translateZ(0) rotateY(-3deg) rotateX(2deg) translateY(-3px) scale(1.05);
  box-shadow:
    3px 3px 0px rgba(58, 62, 66, 0.6),
    8px 10px 18px rgba(0, 0, 0, 0.4);
}

/* Ensure prose content sections have grey backgrounds instead of white */
.prose,
.prose * {
  background-color: transparent !important;
}

.prose pre,
.prose code,
.prose blockquote,
.prose table,
.prose thead,
.prose tbody,
.prose tr,
.prose td,
.prose th {
  background-color: #1f2937 !important;
  color: #e5e7eb !important;
}

.prose blockquote {
  border-left-color: #4b5563 !important;
}

.prose a {
  color: #60a5fa !important;
}

.prose a:hover {
  color: #93c5fd !important;
}

/* Ensure service detail pages and all content sections have grey backgrounds */
main.bg-gray-700,
main.bg-gray-700 *:not(button):not(.bg-white):not(.bg-black) {
  background-color: #374151 !important;
}

/* Override any white backgrounds in service detail content */
main.bg-gray-700 .prose p,
main.bg-gray-700 .prose div,
main.bg-gray-700 .prose section,
main.bg-gray-700 .prose article {
  background-color: transparent !important;
}

/* ============================================
   SECTION BACKGROUND RULES - FINAL OVERRIDE
   These rules come last to ensure they override everything
   ============================================ */

/* Ensure sections with bg-gray-700 maintain their background */
section#services.bg-gray-700,
section#portfolio.bg-gray-700,
section#careers.bg-gray-700 {
  background-color: #374151 !important;
}

/* Ensure footer is always visible and properly positioned */
footer {
  position: relative !important;
  z-index: 10 !important;
  display: block !important;
  width: 100% !important;
}

/* ============================================
   ULTRA-WIDE SCREEN CONSTRAINTS
   Prevent excessive width on 4K+ displays
   ============================================ */
@media (min-width: 2560px) {
  /* Constrain max-w-7xl containers for content readability */
  .max-w-7xl {
    max-width: 1800px;
  }

  /* Sections now span full width to match fixed background */
  /* Inner content containers use max-w-7xl for readability */
}

/* ============================================
   MOBILE LANDSCAPE OPTIMIZATIONS
   Fix layout issues in landscape orientation
   ============================================ */

/* Hero section landscape adjustments */
@media (max-height: 600px) and (orientation: landscape) {
  #hero {
    min-height: 85vh !important;
  }

  /* Removed margin-top override - let inline style control positioning */
  /* #hero .relative.z-10 {
    margin-top: 40px !important;
  } */

  .hero-3d-text {
    font-size: clamp(2rem, 5vw, 3.5rem) !important;
  }

  .hero-since {
    font-size: 0.8em !important;
  }
}

/* About section landscape adjustments */
@media (max-height: 600px) and (orientation: landscape) {
  #about {
    padding-top: 3rem !important;
    padding-bottom: 3rem !important;
  }
}

/* General landscape text sizing */
@media (max-height: 500px) and (orientation: landscape) {
  .section-title {
    font-size: clamp(1.5rem, 4vw, 2.5rem) !important;
  }
}

/* ============================================
   iOS/SAFARI ANIMATION OPTIMIZATIONS
   Force GPU acceleration and smooth scrolling
   ============================================ */

/* Respect reduced motion preference for accessibility */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* GPU hints only for specific animated elements, not broad wildcards */
@media (prefers-reduced-motion: no-preference) {
  .hero-button-3d {
    -webkit-backface-visibility: hidden;
    backface-visibility: hidden;
  }
}

/* CSS Containment for better rendering performance on iOS */
@supports (contain: layout style paint) {
  section:not(#hero):not(#contact) {
    contain: layout style paint;
  }
}

/* Content visibility for off-screen sections (Safari 17+) */
@supports (content-visibility: auto) {
  section:not(#hero):not(#contact) {
    content-visibility: auto;
    contain-intrinsic-size: auto 500px;
  }
}

/* Enhanced scroll performance for iOS */
html {
  -webkit-overflow-scrolling: touch;
}

body {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain; /* Smoother than 'none' for Chrome */
  scroll-behavior: smooth;
}

/* Optimize scrollable containers */
.overflow-y-auto,
.overflow-auto {
  -webkit-overflow-scrolling: touch;
}

/* Prevent iOS Safari from flickering during tap */
* {
  -webkit-tap-highlight-color: transparent;
}

/* ============================================
   NATIVE FADE-IN ANIMATIONS
   Replaces Framer Motion whileInView for better iOS performance
   ============================================ */
.fade-in-native {
  opacity: 0;
  transform: translateY(16px);
  transition:
    opacity 0.3s cubic-bezier(0.16, 1, 0.3, 1),
    transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
}

.fade-in-native--visible {
  opacity: 1;
  transform: translateY(0);
}

/* Remove transition on reduced motion */
@media (prefers-reduced-motion: reduce) {
  .fade-in-native {
    transition: none;
    opacity: 1;
    transform: none;
  }
}

/* ============================================
   MOBILE OPTIMIZATIONS
   ============================================ */

@media (max-width: 767px) {
  /* Safety Section Mobile Layout */
  /* Stack safety section vertically */
  #safety > div > div {
    flex-direction: column !important;
  }

  /* Safety text full width */
  #safety > div > div > div:first-child {
    width: 100% !important;
  }

  /* Logo loop container - full width on mobile */
  #safety > div > div > div:last-child {
    width: 100% !important;
  }

  /* Ensure logo loop ribbon is visible and full width */
  #safety [data-testid='safety-ribbon'] {
    position: relative !important;
    width: 100% !important;
  }

  /* Force CSS animations on logo loop tracks - with Safari iOS webkit prefixes */
  /* Keyframes are defined in tailwind.config.js to prevent build-time purging */
  #safety [data-testid='safety-ribbon'] > div > div:first-child .logoloop__track[style] {
    -webkit-animation-name: scrollLeft !important;
    -webkit-animation-duration: 15s !important;
    -webkit-animation-timing-function: linear !important;
    -webkit-animation-iteration-count: infinite !important;
    -webkit-animation-play-state: running !important;
    animation-name: scrollLeft !important;
    animation-duration: 15s !important;
    animation-timing-function: linear !important;
    animation-iteration-count: infinite !important;
    animation-play-state: running !important;
  }

  /* Second loop scrolls right */
  #safety [data-testid='safety-ribbon'] > div > div:nth-child(2) .logoloop__track[style] {
    -webkit-animation-name: scrollRight !important;
    -webkit-animation-duration: 15s !important;
    -webkit-animation-timing-function: linear !important;
    -webkit-animation-iteration-count: infinite !important;
    -webkit-animation-play-state: running !important;
    animation-name: scrollRight !important;
    animation-duration: 15s !important;
    animation-timing-function: linear !important;
    animation-iteration-count: infinite !important;
    animation-play-state: running !important;
  }

  /* Force GPU acceleration for Safari iOS */
  #safety .logoloop__track {
    -webkit-transform: translateZ(0) !important;
    transform: translateZ(0) !important;
    -webkit-transform-style: preserve-3d !important;
    transform-style: preserve-3d !important;
    -webkit-backface-visibility: hidden !important;
    backface-visibility: hidden !important;
  }

  /* Services Section Mobile Layout */
  /* Services main container - stack vertically */
  #services > div > div.flex {
    flex-direction: column !important;
    gap: 2rem !important;
  }

  /* Service boxes column - full width, remove padding */
  #services > div > div.flex > div:first-child {
    width: 100% !important;
    padding-right: 0 !important;
  }

  /* Service boxes - better mobile sizing */
  #services .space-y-4 > div {
    padding: 1.25rem !important;
    border-radius: 0.75rem !important;
  }

  /* Service box text */
  #services .space-y-4 > div h3 {
    font-size: 1.125rem !important;
  }

  #services .space-y-4 > div p {
    font-size: 0.875rem !important;
  }

  /* Delivery methods column - full width */
  #services > div > div.flex > div:last-child {
    width: 100% !important;
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  /* Delivery methods container - stack vertically */
  #services .flex.flex-col.rounded-l-2xl {
    border-radius: 0.75rem !important;
  }

  /* Delivery methods nav row */
  #services .flex.flex-col.rounded-l-2xl > div:last-child {
    flex-direction: column !important;
  }

  /* Nav sidebar becomes horizontal tabs */
  #services .flex.flex-col.rounded-l-2xl > div:last-child > div:first-child {
    width: 100% !important;
    flex-direction: row !important;
    overflow-x: auto !important;
    border-right: none !important;
    border-bottom: 1px solid #e5e7eb !important;
  }

  /* Tab buttons */
  #services .flex.flex-col.rounded-l-2xl button {
    min-width: 70px !important;
    padding: 1rem !important;
  }

  /* Content area below tabs */
  #services .flex.flex-col.rounded-l-2xl > div:last-child > div:last-child {
    width: 100% !important;
  }

  /* Full-width form inputs on mobile */
  #services input,
  #services textarea,
  #services select {
    font-size: 16px !important; /* Prevent zoom on iOS */
  }

  /* Improve button sizing */
  #services button[type='submit'] {
    padding: 14px 20px;
    min-height: 48px;
  }
}

/* ============================================
   MOBILE TOUCH OPTIMIZATIONS
   ============================================ */

@media (max-width: 767px) {
  /* Minimum touch target size for all interactive elements */
  button,
  a[role='button'],
  .nav-card-link,
  .carousel-nav-button,
  .dock-item {
    min-width: 44px;
    min-height: 44px;
  }

  /* Better tap feedback with visual response */
  button:active,
  a[role='button']:active {
    opacity: 0.7;
    transform: scale(0.98);
    transition:
      opacity 0.1s ease,
      transform 0.1s ease;
  }

  /* Remove 300ms tap delay on all interactive elements */
  a,
  button,
  input,
  select,
  textarea {
    touch-action: manipulation;
  }

  /* Prevent text selection on interactive elements during tap */
  button,
  .nav-card-link,
  .carousel-nav-button {
    -webkit-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
  }

  /* Improve scroll performance on mobile */
  .overflow-y-auto,
  .overflow-auto,
  .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Larger click areas for small elements */
  .carousel-nav-button {
    padding: 12px;
  }

  /* Ensure nav links are easily tappable */
  nav a,
  nav button {
    padding: 12px 16px;
    min-height: 44px;
  }
}

/* ============================================
   MOBILE TYPOGRAPHY & SPACING
   ============================================ */

@media (max-width: 767px) {
  /* Hero text adjustments for mobile */
  .hero-3d-text {
    font-size: clamp(2.5rem, 8vw, 4rem) !important;
    -webkit-text-stroke: 2px rgba(0, 0, 0, 0.6) !important;
  }

  /* Section titles optimized for mobile screens */
  .section-title {
    font-size: clamp(2rem, 7vw, 3.5rem) !important;
    line-height: 1.2 !important;
  }

  /* Body text readability improvements */
  body {
    font-size: 16px; /* Prevent iOS zoom on input focus */
    line-height: 1.6;
  }

  /* Increase spacing for breathing room on mobile */
  section {
    padding-left: 1rem !important;
    padding-right: 1rem !important;
  }

  .max-w-7xl {
    padding-left: 1.5rem;
    padding-right: 1.5rem;
  }

  /* Adjust heading sizes for better readability */
  h1 {
    font-size: clamp(2rem, 6vw, 2.5rem);
    line-height: 1.2;
  }

  h2 {
    font-size: clamp(1.75rem, 5vw, 2.25rem);
    line-height: 1.3;
  }

  h3 {
    font-size: clamp(1.5rem, 4vw, 1.875rem);
    line-height: 1.4;
  }

  /* Better paragraph spacing */
  p {
    margin-bottom: 1rem;
    line-height: 1.7;
  }

  /* Comfortable list spacing */
  ul,
  ol {
    padding-left: 1.5rem;
    margin-bottom: 1rem;
  }

  li {
    margin-bottom: 0.5rem;
  }
}

/* Extra small phones (iPhone SE, etc.) */
@media (max-width: 375px) {
  .hero-3d-text {
    font-size: clamp(2rem, 9vw, 3rem) !important;
  }

  .section-title {
    font-size: clamp(1.75rem, 8vw, 2.5rem) !important;
  }

  /* Slightly reduce padding on very small screens */
  section {
    padding-left: 0.75rem !important;
    padding-right: 0.75rem !important;
  }
}

/* ============================================
   MOBILE FORMS & MODALS OPTIMIZATION
   ============================================ */

@media (max-width: 767px) {
  /* Contact form mobile optimization */
  #contact .grid {
    grid-template-columns: 1fr !important;
  }

  /* Optimize all form input sizing for mobile */
  input,
  textarea,
  select {
    font-size: 16px !important; /* Prevent iOS zoom on focus */
    padding: 14px 12px !important;
    width: 100%;
  }

  /* Full-width submit buttons with better touch targets */
  button[type='submit'] {
    width: 100%;
    padding: 16px;
    font-size: 18px;
    min-height: 48px;
  }

  /* Form field spacing */
  form > div,
  form > input,
  form > textarea,
  form > select {
    margin-bottom: 1rem;
  }

  /* Portfolio modal mobile fixes */
  .modal,
  .modal-content {
    width: calc(100vw - 32px) !important;
    max-width: calc(100vw - 32px) !important;
    margin: 16px;
    max-height: calc(100vh - 32px);
    overflow-y: auto;
  }

  .modal-overlay {
    padding: 16px;
    align-items: flex-start;
  }

  /* Modal images full width on mobile */
  .modal img,
  .modal-content img {
    width: 100%;
    height: auto;
  }

  /* Modal close button easier to tap */
  .modal button,
  .modal-content button {
    min-width: 44px;
    min-height: 44px;
    padding: 12px 20px;
  }
}

/* Extra small phone modal adjustments */
@media (max-width: 375px) {
  .modal,
  .modal-content {
    width: calc(100vw - 24px) !important;
    margin: 12px;
  }

  .modal-overlay {
    padding: 12px;
  }
}

/* ============================================
   iOS SAFE AREA SUPPORT (Notch/Dynamic Island)
   ============================================ */

@supports (padding: max(0px)) {
  /* Fixed header elements respect safe areas */
  .fixed.top-4 {
    top: max(16px, env(safe-area-inset-top)) !important;
  }

  /* Logo positioning with safe area */
  .plaque-perspective {
    top: max(16px, env(safe-area-inset-top)) !important;
    left: max(16px, env(safe-area-inset-left)) !important;
  }

  /* CardNav hamburger menu */
  .card-nav-container {
    top: max(16px, env(safe-area-inset-top)) !important;
    left: max(16px, env(safe-area-inset-left)) !important;
    right: max(16px, env(safe-area-inset-right)) !important;
  }

  /* Footer padding for home indicator */
  footer {
    padding-bottom: max(40px, env(safe-area-inset-bottom)) !important;
  }

  /* Full-screen modals respect safe areas */
  .modal-overlay {
    padding-top: max(16px, env(safe-area-inset-top));
    padding-bottom: max(16px, env(safe-area-inset-bottom));
    padding-left: max(16px, env(safe-area-inset-left));
    padding-right: max(16px, env(safe-area-inset-right));
  }

  /* Dock safe area (though hidden on mobile) */
  .dock-outer {
    top: max(16px, env(safe-area-inset-top)) !important;
    right: max(16px, env(safe-area-inset-right)) !important;
  }

  /* Hero section content safe area */
  /* Adjusted to not conflict with inline marginTop - only handle safe area inset */
  #hero .relative.z-10 {
    padding-top: max(0px, env(safe-area-inset-top));
  }

  /* Section padding for safe areas */
  body {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
}

/* ============================================
   PORTFOLIO GRID MOBILE OPTIMIZATION
   ============================================ */

@media (max-width: 767px) {
  /* Single column on mobile with better spacing */
  #portfolio .grid {
    grid-template-columns: 1fr !important;
    gap: 0 !important;
  }

  /* Optimize image aspect ratio for mobile viewing */
  #portfolio .relative {
    padding-bottom: 56.25% !important; /* 16:9 ratio better for mobile */
  }

  /* Larger, more readable text on category cards */
  #portfolio h3 {
    font-size: clamp(2rem, 6vw, 2.5rem) !important;
    padding: 1rem;
  }

  /* Better hover/tap overlay on mobile */
  #portfolio .group .absolute {
    opacity: 0;
    transition: opacity 0.2s ease;
  }

  /* Show overlay on tap/touch */
  #portfolio .group:active .absolute,
  #portfolio .group:focus .absolute {
    opacity: 1;
  }

  /* Larger "Learn more" text */
  #portfolio .group .flex span {
    font-size: 1.125rem;
  }

  /* Portfolio section title */
  #portfolio h2 {
    font-size: clamp(2.5rem, 7vw, 3.5rem) !important;
    margin-bottom: 2rem;
  }

  /* Portfolio description */
  #portfolio p {
    font-size: 1.125rem;
    line-height: 1.7;
  }

  /* Better image loading on mobile */
  #portfolio img {
    object-fit: cover;
    width: 100%;
    height: 100%;
  }

  /* Force visibility only on Portfolio section to prevent white flash on mobile */
  /* Other sections should retain their Framer Motion animations */
  #portfolio [data-framer-motion] {
    opacity: 1 !important;
  }

  /* Force portfolio grid items and images to be visible */
  #portfolio .grid > div {
    display: block !important;
    opacity: 1 !important;
  }

  #portfolio .relative {
    display: block !important;
    position: relative !important;
    opacity: 1 !important;
    background-color: #e5e7eb !important; /* Gray placeholder */
  }

  #portfolio img {
    opacity: 1 !important;
    display: block !important;
  }

  /* Ensure grid container is visible with smooth background */
  #portfolio .bg-white {
    display: block !important;
    min-height: 200px !important;
    background-color: #ffffff !important;
  }

  /* Force category cards to be visible with placeholder background */
  #portfolio .group {
    opacity: 1 !important;
    visibility: visible !important;
    background-color: #e5e7eb !important;
  }
}

/* ============================================
   CAREERS MOBILE OPTIMIZATION
   ============================================ */

@media (max-width: 767px) {
  /* Remove negative margin on mobile to prevent portfolio overlap */
  #careers {
    margin-top: 0 !important;
    padding-top: 3rem !important;
  }

  /* Ensure careers section is visible and not covered */
  #careers {
    position: relative !important;
    z-index: 5 !important;
  }
}

/* ============================================
   MOBILE PERFORMANCE OPTIMIZATIONS
   ============================================ */

/* Enhanced reduced motion for mobile devices */
@media (max-width: 767px) and (prefers-reduced-motion: reduce), (max-width: 767px) {
  /* Disable complex 3D transforms on mobile for better performance */
  .hero-button-3d,
  .logo-3d-card,
  .dock-panel {
    transform: none !important;
    filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.2)) !important;
    transition: opacity 0.2s ease !important;
  }

  /* Simplify all transitions for better battery life */
  *:not(.logoloop__track) {
    animation-duration: 0.2s !important;
    transition-duration: 0.2s !important;
  }

  /* Reduce motion on framer-motion elements */
  [data-framer-motion] {
    animation-duration: 0.15s !important;
  }
}

/* Additional mobile-specific performance hints */
@media (max-width: 767px) {
  /* Remove will-change from all elements to reduce jitter, except LogoLoop */
  *:not(.logoloop__track) {
    will-change: auto !important;
  }

  .logoloop__track {
    will-change: transform !important;
  }

  /* Override will-change removal for Careers/Contact animations to prevent white flashing */
  /* These sections need GPU acceleration on mobile due to simultaneous opacity+transform */
  #careers [data-framer-motion],
  #contact [data-framer-motion] {
    will-change: opacity, transform !important;
    backface-visibility: hidden !important;
    -webkit-backface-visibility: hidden !important;
    transform: translateZ(0) !important;
    -webkit-transform: translateZ(0) !important;
  }

  /* Removed: broad will-change/translateZ(0) on section children — promoted too many GPU layers */

  /* Removed: *:hover/*:focus/*:active will-change — caused too many GPU layers */

  /* Simplify transforms - use translate instead of translate3d */
  [style*='translate3d']:not(.logoloop__track):not(.logoloop *) {
    transform: none !important;
  }

  /* Reduce transition complexity */
  * {
    transition-timing-function: ease !important;
  }

  /* Disable complex text animations on static sections only */
  /* Hero, Portfolio, Careers, and Contact need GPU acceleration for smooth text fades */
  .section-title:not(#hero *, #portfolio *, #careers *, #contact *) {
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5) !important;
    -webkit-text-stroke: 1px rgba(0, 0, 0, 0.4) !important;
    will-change: auto !important;
    transform: none !important;
  }

  /* Hero text needs full GPU acceleration for smooth opacity transitions */
  #hero .hero-3d-text {
    will-change: opacity, transform !important;
    backface-visibility: hidden !important;
    -webkit-backface-visibility: hidden !important;
  }

  /* Simplify carousel to reduce containment issues */
  .carousel-wrapper,
  .carousel-container {
    contain: none !important;
  }

  /* Ensure About section carousel is full width and centered */
  #about .carousel-wrapper {
    width: 100% !important;
    max-width: 100% !important;
  }

  #about .carousel-container {
    width: 100% !important;
    max-width: 100% !important;
    margin: 0 auto;
  }

  /* Disable 3D transforms on carousel items for mobile */
  #about .carousel-item {
    transform: none !important;
  }

  /* Ensure About section is visible and not hidden */
  #about {
    display: block !important;
    visibility: visible !important;
  }

  /* Mobile image optimization */

  /* Reduce animation complexity on mobile */
  @keyframes fadeIn {
    from {
      opacity: 0;
    }
    to {
      opacity: 1;
    }
  }

  @keyframes slideIn {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
}
